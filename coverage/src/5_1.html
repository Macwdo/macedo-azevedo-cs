<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>/home/macwdo/Work/MacedoAzevedo/Macedo-azevedo-cs/Ma.API/Controllers/V1/Registry/RegistryController.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Ma.API.Exceptions;
using Ma.API.Models.Registry;
using Ma.API.Services;
using Microsoft.AspNetCore.Mvc;

namespace Ma.API.Controllers.V1.Registry;

[ApiController]
[Route(&quot;api/v1/registries&quot;)]
public class RegistryController: ControllerBase
{
    private readonly IRegistryService _registryService;

    public RegistryController(IRegistryService registryService)
    {
        _registryService = registryService;
    }

    [HttpGet]
    [ProducesResponseType(StatusCodes.Status200OK, Type = typeof(IEnumerable&lt;ReadRegistryDto&gt;))]
    [ProducesResponseType(StatusCodes.Status500InternalServerError, Type = typeof(ProblemDetails))]
    public IActionResult GetAll()
    {
        var registries = _registryService.GetRegistries();
        return Ok(registries);
    }

    [HttpGet(&quot;{id:int}&quot;)]
    [ProducesResponseType(StatusCodes.Status200OK, Type = typeof(ReadRegistryDto))]
    [ProducesResponseType(StatusCodes.Status404NotFound)]
    [ProducesResponseType(StatusCodes.Status500InternalServerError, Type = typeof(ProblemDetails))]
    public IActionResult Get(int id)
    {
        var registry = _registryService.GetRegistry(id);
        if (registry is null)
            return NotFound();

        return Ok(registry);
    }

    [HttpPost]
    [ProducesResponseType(StatusCodes.Status201Created, Type = typeof(ReadRegistryDto))]
    [ProducesResponseType(StatusCodes.Status400BadRequest, Type = typeof(ValidationProblemDetails))]
    [ProducesResponseType(StatusCodes.Status500InternalServerError, Type = typeof(ProblemDetails))]
    public IActionResult Create([FromBody] CreateRegistryDto createRegistryDto){
        var readRegistryDto = _registryService.CreateRegistry(createRegistryDto);

        return CreatedAtAction(nameof(Get), new {id = readRegistryDto.Id}, readRegistryDto);
    }

    [HttpPut(&quot;{id:int}&quot;)]
    public IActionResult Put(int id, [FromBody] UpdateRegistryDto updateRegistryDto)
    {
        try
        {
            var readRegistryDto = _registryService.UpdateRegistry(id, updateRegistryDto);
            return Ok(readRegistryDto);
        }
        catch (NotFoundEntityException)
        {
            return NotFound($&quot;Error: Registry by id={id} not found.&quot;);
        }
    }

    [HttpDelete(&quot;{id:int}&quot;)]
    [ProducesResponseType(StatusCodes.Status204NoContent)]
    [ProducesResponseType(StatusCodes.Status404NotFound)]
    [ProducesResponseType(StatusCodes.Status500InternalServerError, Type = typeof(ProblemDetails))]
    public IActionResult Delete(int id)
    {
        try
        {
            _registryService.DeleteRegistry(id);
            return NoContent();
        }
        catch (NotFoundEntityException)
        {
            return NotFound($&quot;Error: Registry by id={id} not found.&quot;);
        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,5,14,64,0],[15,5,15,6,0],[16,9,16,44,0],[17,5,17,6,0],[23,5,23,6,0],[24,9,24,59,0],[25,9,25,31,0],[26,5,26,6,0],[33,5,33,6,0],[34,9,34,57,0],[35,9,35,30,0],[36,13,36,31,0],[38,9,38,29,0],[39,5,39,6,0],[45,80,45,81,0],[46,9,46,82,0],[48,9,48,93,0],[49,5,49,6,0],[53,5,53,6,0],[55,9,55,10,0],[56,13,56,90,0],[57,13,57,40,0],[59,9,59,40,0],[60,9,60,10,0],[61,13,61,71,0],[63,5,63,6,0],[70,5,70,6,0],[72,9,72,10,0],[73,13,73,49,0],[74,13,74,32,0],[76,9,76,40,0],[77,9,77,10,0],[78,13,78,71,0],[81,5,81,6,0]]);
    </script>
  </body>
</html>